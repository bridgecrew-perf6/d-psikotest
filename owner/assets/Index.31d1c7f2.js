import{u as J,f as K,b as O,d as q,e as E,r as c,n as j,l as W,o as r,g as l,h as e,i as b,w as P,p as z,t as d,q as X,F as Y,k as p,A as u,T as h,s as A}from"./index.04432143.js";import{B as Z,a as Q}from"./BreadCrumbSpace.32ca9e1b.js";const ee={class:"pt-4 px-10 md:flex justify-between"},te=e("div",null,[e("span",{class:"text-2xl sm:text-3xl leading-none font-bold text-base-content shadow-sm"},"APIPROBK ")],-1),oe={class:"md:py-0 py-4"},se=p(" APIPROBK "),ae=p(" Index "),ne={class:"md:pt-6"},re={class:"md:flex justify-between px-10"},le={class:"space-x-1 space-y-1 pt-1 md:pt-0"},ie=e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"})],-1),de=p(" Backup "),ce=[ie,de],ue=e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"})],-1),he=p(" Sikron "),pe=[ue,he],ge={class:"space-x-1 space-y-1 pt-1 md:pt-0"},ke=e("label",{for:"modalImport",class:"btn modal-button btn-info hover:shadow-lg shadow text-white hover:text-gray-100 gap-2"},[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"})]),p(" Import ")],-1),ve=e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"})],-1),_e=p(" Clear Temp "),me=[ve,_e],we={class:"md:pt-6"},fe={class:"md:flex justify-center px-10 gap-4"},xe={class:"space-x-1 space-y-1 pt-1 md:pt-0 flex justify-end w-full"},be={class:"space-x-1 space-y-1 pt-1 md:pt-0 w-full"},ye={class:"space-x-1 space-y-1 pt-1 md:pt-0 flex justify-end w-full"},Se={class:"space-x-1 space-y-1 pt-1 md:pt-0 w-full"},Be={class:"md:py-2 px-4 lg:flex flex-wrap gap-4"},Ce={class:"w-full lg:w-full"},De={class:"bg-white shadow rounded-lg px-4 py-4"},Me={key:0},je={key:0},Pe={class:"text-sm font-medium text-center flex justify-center"},ze=["onClick"],Ae=e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})],-1),Ie=[Ae],Ve={key:1},Fe={class:"text-center"},Te={key:2},Ge={class:"text-sm font-medium text-center flex justify-center"},He={key:0,"data-tip":"Sukses",class:"tooltip text-green-100 block rounded-lg font-bold py-1 px-1 mr-2 flex items-center hover:text-green-300 bg-green-400 rounded-lg"},Le=e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"})],-1),$e=[Le],Re={key:1,"data-tip":"Gagal",class:"tooltip text-red-100 block rounded-lg font-bold py-1 px-1 mr-2 flex items-center hover:text-red-300 bg-red-400 rounded-lg"},Ne=e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor"},[e("path",{"fill-rule":"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z","clip-rule":"evenodd"})],-1),Ue=[Ne],Je={key:2,"data-tip":"Belum",class:"tooltip text-gray-100 block rounded-lg font-bold py-1 px-1 mr-2 flex items-center hover:text-gray-300 bg-gray-400"},Ke=e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})],-1),Oe=[Ke],qe={key:3},Ee={class:"text-sm font-medium text-center flex justify-center"},We={key:0,"data-tip":"Sukses",class:"tooltip text-green-100 block rounded-lg font-bold py-1 px-1 mr-2 flex items-center hover:text-green-300 bg-green-400"},Xe=e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"})],-1),Ye=[Xe],Ze={key:1,"data-tip":"Gagal",class:"tooltip text-red-100 block rounded-lg font-bold py-1 px-1 mr-2 flex items-center hover:text-red-300 bg-red-400 rounded-lg"},Qe=e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor"},[e("path",{"fill-rule":"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z","clip-rule":"evenodd"})],-1),et=[Qe],tt={key:2,"data-tip":"Belum",class:"tooltip text-gray-100 block rounded-lg font-bold py-1 px-1 mr-2 flex items-center hover:text-gray-300 bg-gray-400 rounded-lg"},ot=e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})],-1),st=[ot],at={key:4},nt={class:"text-sm font-medium text-center flex justify-center"},rt={key:0,"data-tip":"Sukses",class:"tooltip text-green-100 block rounded-lg font-bold py-1 px-1 mr-2 flex items-center hover:text-green-300 bg-green-400"},lt=e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"})],-1),it=[lt],dt={key:1,"data-tip":"Gagal",class:"tooltip text-red-100 block rounded-lg font-bold py-1 px-1 mr-2 flex items-center hover:text-red-300 bg-red-400 rounded-lg"},ct=e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor"},[e("path",{"fill-rule":"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z","clip-rule":"evenodd"})],-1),ut=[ct],ht={key:2,"data-tip":"Belum",class:"tooltip text-gray-100 block rounded-lg font-bold py-1 px-1 mr-2 flex items-center hover:text-gray-300 bg-gray-400 rounded-lg"},pt=e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})],-1),gt=[pt],kt={key:5},vt=e("input",{type:"checkbox",id:"modalImport",class:"modal-toggle"},null,-1),_t={class:"modal"},mt={class:"modal-box w-11/12 max-w-5xl"},wt=e("label",{for:"modalImport",class:"btn btn-sm btn-circle absolute right-2 top-2"},"\u2715",-1),ft=e("h3",{class:"font-bold text-lg"},"Import data menggunakan .xlx / .xlxs !",-1),xt={class:"py-4"},bt=e("div",{class:"modal-action"},null,-1),Mt={__name:"Index",setup(yt){const y=J();K(()=>y.getSekolah),y.$subscribe((t,o)=>{}),O().setPagesActive("apiprobk"),q(),E();const I=c([]),a=c([]),g=async()=>{try{const t=await u.get("owner/apiprobk/all");return I.value=t.data,a.value=t.data,k.value=a.value.filter(o=>o.sertifikat=="belum").length,v.value=a.value.filter(o=>o.sertifikat=="sudah"&&o.deteksi=="sudah"&&o.sinkron=="belum").length,i.value=0,_.value=0,t}catch(t){console.error(t)}};g();const V=[{label:"Actions",field:"actions",sortable:!1,width:"50px",tdClass:"text-center",thClass:"text-center"},{label:"Username",field:"username",type:"String"},{label:"Sertifikat",field:"sertifikat",type:"String"},{label:"Status Get Data",field:"sertifikat_tgl",type:"String"},{label:"Deteksi",field:"deteksi",type:"String"},{label:"Status Deteksi Data",field:"deteksi_tgl",type:"String"},{label:"Sinkron",field:"sinkron",type:"String"},{label:"Status Sinkron Data",field:"sinkron_tgl",type:"String"}],S=c(null);let B=new FormData;const F=async t=>{try{const o=await u.post("owner/apiprobk/upload",B,{headers:{"Content-Type":"multipart/form-data"}});return g(),o.data}catch(o){console.error(o)}},T=async()=>{B.append("file",S.value.files[0]),F()},G=async t=>{try{const o=await u.post("owner/proses/cleartemp",{headers:{"Content-Type":"multipart/form-data"}});return h.success("Success","Clear Temporary File Berhasil dilakukan!"),o.data}catch(o){console.error(o)}},k=c(0),i=c(0),m=c(0);let f={},x={};j(i,async(t,o)=>{t!=o&&k.value>0&&(m.value=(t/(k.value*2)*100).toFixed(2),m.value==100&&h.success("Info","Proses Backup Selesai!"))});const H=async(t,o)=>{try{const n=await u.post("owner/apiprobk/api_backup",t);return a.value[o].deteksi="sudah",i.value++,n.data}catch(n){i.value++,a.value[o].deteksi="gagal",console.error(n)}},L=async(t,o)=>{try{const n=await u.post("owner/apiprobk/api_backup_deteksi",t);return a.value[o].deteksi="sudah",i.value++,n.data}catch(n){i.value++,a.value[o].deteksi="gagal",console.error(n)}},C=async(t,o)=>{try{const n=await u.post("owner/apiprobk/gagal",{id:t});return a.value[o].sertifikat="gagal",a.value[o].deteksi="gagal",i.value++,n.data}catch(n){i.value++,a.value[o].sertifikat="gagal",a.value[o].deteksi="gagal",console.error(n)}},D=async(t,o=0,n=0)=>{try{const s=await A.post("http://161.97.84.91:9001/api/probk/DataSertifikat_Get",{username:t},{headers:{}});return f=s.data,f.apiprobk_id=o,H(f,n),a.value[n].sertifikat="sudah",s}catch(s){C(o,n),console.error(s)}},M=async(t,o=0,n=0)=>{try{const s=await A.post("http://161.97.84.91:9001/api/probk/DataDeteksi_Get",{username:t},{headers:{}});return x=s.data,x.apiprobk_id=o,L(x,n),a.value[n].sertifikat="sudah",s}catch(s){C(o,n),console.error(s)}},$=async()=>{if(confirm("Apakah anda yakin melakukan proses ini?"))try{g(),h.success("Info","Proses backup di mulai, Tunggu hingga selesai!"),i.value=0;for(let t=0;t<a.value.length;t++)(a.value[t].sertifikat=="belum"||a.value[t].sertifikat=="gagal")&&D(a.value[t].username,a.value[t].id,t),(a.value[t].deteksi=="belum"||a.value[t].deteksi=="gagal")&&M(a.value[t].username,a.value[t].id,t)}catch(t){console.error(t)}},R=async(t,o,n)=>{confirm("Apakah anda yakin melakukan backup data ini?")&&(h.success("Info","Proses backup di mulai, Tunggu hingga selesai!"),D(n,t,o),M(n,t,o),g())},v=c(0),_=c(0),w=c(0);j(_,async(t,o)=>{t!=o&&v.value>0&&(w.value=(t/v.value*100).toFixed(2),w.value==100&&h.success("Info","Proses Sinkron Selesai!"))});const N=async(t,o=0,n=0)=>{try{const s=await u.post("owner/apiprobk/sinkron",{username:t,apiprobk_id:o});return a.value[n].sinkron="sudah",_.value++,s.data}catch(s){_.value++,a.value[n].sinkron="gagal",console.error(s)}},U=async()=>{if(confirm("Apakah anda yakin melakukan Sinkron Data ini?")){h.success("Info","Proses Sinkron di mulai, Tunggu hingga selesai!"),g();for(let t=0;t<a.value.length;t++)a.value[t].sertifikat=="sudah"&&a.value[t].deteksi=="sudah"&&a.value[t].sinkron=="belum"&&N(a.value[t].username,a.value[t].id,t)}};return(t,o)=>{const n=W("vue-good-table");return r(),l(Y,null,[e("div",ee,[te,e("div",oe,[b(Z,null,{content:P(()=>[se,b(Q),ae]),_:1})])]),e("div",ne,[e("div",re,[e("div",le,[e("button",{onClick:o[0]||(o[0]=s=>$()),class:"btn btn-info hover:shadow-lg shadow text-white hover:text-gray-100 gap-2"},ce),e("button",{onClick:o[1]||(o[1]=s=>U()),class:"btn btn-accent hover:shadow-lg shadow text-white hover:text-gray-100 gap-2"},pe)]),e("div",ge,[ke,e("button",{class:"btn hover:shadow-lg shadow text-white hover:text-gray-100 gap-2",onClick:o[2]||(o[2]=s=>G())},me)])])]),e("div",we,[e("div",fe,[e("div",xe,[e("div",{class:"radial-progress bg-primary text-primary-content border-4 border-primary",style:z({"--value":m.value})},d(m.value)+"% ",5)]),e("div",be,[e("h1",null,"Proses : "+d(i.value)+" / "+d(k.value*2),1),e("h1",null,"Jumlah Data :"+d(k.value),1)]),e("div",ye,[e("div",{class:"radial-progress bg-accent text-accent-content border-4 border-accent",style:z({"--value":w.value})},d(w.value)+"% ",5)]),e("div",Se,[e("h1",null,"Proses : "+d(_.value)+" / "+d(v.value),1),e("h1",null,"Jumlah Data :"+d(v.value),1)])])]),e("div",Be,[e("div",Ce,[e("div",De,[a.value?(r(),l("div",Me,[b(n,{"line-numbers":!0,columns:V,rows:a.value,"search-options":{enabled:!0},"pagination-options":{enabled:!0,perPageDropdown:[10,20,50]},styleClass:"vgt-table striped bordered condensed",class:"py-0"},{"table-row":P(s=>[s.column.field=="actions"?(r(),l("span",je,[e("div",Pe,[e("button",{onClick:Bt=>R(s.row.id,s.index,s.row.username),"data-tip":"Backup",class:"tooltip text-orange-100 block rounded-lg font-bold py-1 px-1 mr-2 flex items-center hover:text-orange-300 bg-orange-400 rounded-lg"},Ie,8,ze)])])):s.column.field=="no"?(r(),l("span",Ve,[e("div",Fe,d(s.index+1),1)])):s.column.field=="sertifikat"?(r(),l("span",Te,[e("div",Ge,[s.row.sertifikat=="sudah"?(r(),l("button",He,$e)):s.row.sertifikat=="gagal"?(r(),l("button",Re,Ue)):(r(),l("button",Je,Oe))])])):s.column.field=="deteksi"?(r(),l("span",qe,[e("div",Ee,[s.row.deteksi=="sudah"?(r(),l("button",We,Ye)):s.row.deteksi=="gagal"?(r(),l("button",Ze,et)):(r(),l("button",tt,st))])])):s.column.field=="sinkron"?(r(),l("span",at,[e("div",nt,[s.row.sinkron=="sudah"?(r(),l("button",rt,it)):s.row.sinkron=="gagal"?(r(),l("button",dt,ut)):(r(),l("button",ht,gt))])])):(r(),l("span",kt,d(s.formattedRow[s.column.field]),1))]),_:1},8,["rows"])])):X("",!0)])])]),vt,e("div",_t,[e("div",mt,[wt,ft,e("div",xt,[e("input",{type:"file",ref_key:"file",ref:S},null,512),e("button",{class:"btn btn-info text-gray-100",onClick:o[3]||(o[3]=s=>T())}," Upload ")]),bt])])],64)}}};export{Mt as default};
